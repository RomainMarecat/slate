<mat-toolbar color="primary" *ngIf="showBackButton === true">
  <a [routerLink]="['/admin/map']">
    <mat-icon color="warn">navigate_before</mat-icon>
  </a>
</mat-toolbar>
<div fxLayout="row"
     fxLayoutAlign="space-around stretch"
     fxLayoutGap="20px">

  <div class="form-wrapper"
       fxFlex="30"
       fxLayout="column"
       fxLayoutAlign="center start">

    <form [formGroup]="form"
          (ngSubmit)="saveMap()"
          class="form mt-1">

      <mat-card class="mat-card">
        <mat-card-header fxLayout="row"
                         fxLayoutAlign="center stretch">
          <mat-card-title>
            <h3 *ngIf="!map?.key">
              Ajouter une carte
            </h3>
            <h3 *ngIf="map?.key">
              Editer une carte
            </h3>
          </mat-card-title>
        </mat-card-header>
        <mat-card-content class="mat-card-content">
          <div class="mt-1"
               fxLayout="column"
               fxLayoutAlign="center stretch">
            <mat-form-field class="mat-form-field">
              <input matInput
                     maxlength="100"
                     [placeholder]="'admin.placeholder.map.name'|translate"
                     [formControl]="form.get('name')">
              <mat-hint align="start"><strong [innerHtml]="'admin.hint.map.name'|translate"></strong></mat-hint>
              <mat-hint align="end">{{ form.get('name').value.length }} {{ '/100'|translate }}</mat-hint>
              <mat-error *ngIf="form.get('name').invalid && form.get('name').value.length === 0"
                         [innerHtml]="'admin.error.required.map.name'|translate"></mat-error>
              <mat-error *ngIf="form.get('name').invalid && form.get('name').value.length > 0"
                         [innerHtml]="'admin.error.invalid.map.name'|translate"></mat-error>
            </mat-form-field>
            <div class="d-block mt-1">
              <div class="mat-form-field">
                <mat-radio-group class="example-radio-group"
                                 [(ngModel)]="publication"
                                 [formControl]="form.get('published')">
                  <mat-radio-button class="example-radio-button"
                                    [value]="true">
                    {{ 'cta.publish'|translate }}
                  </mat-radio-button>
                  <mat-radio-button class="example-radio-button"
                                    [value]="false">
                    {{ 'cta.unpublish'|translate }}
                  </mat-radio-button>
                </mat-radio-group>
              </div>
            </div>
          </div>
        </mat-card-content>
        <mat-card-actions>
          <div fxLayout="row"
               fxLayoutAlign="space-around stretch">
            <button type="button"
                    class="back text-uppercase"
                    role="button"
                    color="accent"
                    mat-raised-button
                    [innerHtml]="'cta.cancel'|translate"
                    [routerLink]="['/admin/map']"></button>
            <button type="submit"
                    class="validate text-uppercase"
                    [attr.aria-label]="'cta.save'|translate"
                    mat-raised-button
                    color="primary"
                    [disabled]="form.invalid"
                    [innerHtml]="'cta.save'|translate"></button>
          </div>
        </mat-card-actions>
      </mat-card>
    </form>


    <form [formGroup]="formArea"
          (ngSubmit)="saveArea()"
          class="form mt-1"
          *ngIf="map">
      <mat-card class="mat-card">
        <mat-card-header fxLayout="row"
                         fxLayoutAlign="center stretch">
          <mat-card-subtitle *ngIf="showBackButton === true">
            <button type="button"
                    color="warn"
                    mat-mini-fab
                    class="absolute-fab"
                    [routerLink]="['/admin/map']">
              <mat-icon aria-label="back">arrow_left</mat-icon>
            </button>
          </mat-card-subtitle>
          <mat-card-title>
            <h3 *ngIf="map?.key">
             {{ 'admin.title.map.add'|translate }}
            </h3>
          </mat-card-title>
        </mat-card-header>
        <mat-card-content class="mat-card-content">
          <div class="mt-1"
               fxLayout="column"
               fxLayoutAlign="center stretch">
            <mat-form-field class="mat-form-field">
              <input matInput
                     maxlength="100"
                     [placeholder]="'admin.placeholder.map.name'|translate"
                     [formControl]="formArea.controls.name">
              <mat-hint align="start">
                <strong [innerHtml]="'admin.hint.map.name'|translate"></strong>
              </mat-hint>
              <mat-hint align="end">{{ formArea.controls.name.value.length }} {{ '/100'|translate }}</mat-hint>
              <mat-error *ngIf="formArea.controls.name.invalid && formArea.controls.name.value.length === 0"
                         [innerHtml]="'admin.error.required.map.name'|translate"></mat-error>
              <mat-error *ngIf="formArea.controls.name.invalid && formArea.controls.name.value.length > 0"
                         [innerHtml]="'admin.error.invalid.map.name'|translate"></mat-error>
            </mat-form-field>
            <mat-form-field class="mat-form-field">
              <input matInput
                     maxlength="9000"
                     [placeholder]="'admin.placeholder.map.path'|translate"
                     [formControl]="formArea.controls.path">
              <mat-hint align="start"><strong [innerHtml]="'admin.hint.map.path'|translate"></strong></mat-hint>
              <mat-hint align="end">{{ formArea.controls.path.value.length }} {{ '/9000'|translate }}</mat-hint>
              <mat-error *ngIf="formArea.controls.path.invalid && formArea.controls.path.value.length === 0"
                         [innerHtml]="'admin.error.required.map.path'|translate"></mat-error>
              <mat-error *ngIf="formArea.controls.path.invalid && formArea.controls.path.value.length > 0"
                         [innerHtml]="'admin.error.invalid.map.path'|translate"></mat-error>
            </mat-form-field>
            <div class="d-block mt-1">
              <div class="mat-form-field">
                <mat-radio-group class="example-radio-group"
                                 [(ngModel)]="publicationArea"
                                 [formControl]="formArea.controls.published">
                  <mat-radio-button class="example-radio-button"
                                    [value]="true">
                    {{ 'cta.publish'|translate }}
                  </mat-radio-button>
                  <mat-radio-button class="example-radio-button"
                                    [value]="false">
                    {{ 'cta.unpublish'|translate }}
                  </mat-radio-button>
                </mat-radio-group>
              </div>
            </div>
          </div>
        </mat-card-content>
        <mat-card-actions>
          <div fxLayout="row"
               fxLayoutAlign="space-around stretch">
            <button type="button"
                    class="back text-uppercase"
                    role="button"
                    color="accent"
                    mat-raised-button
                    [innerHtml]="'cta.cancel'|translate"
                    [routerLink]="['/admin/map']"></button>
            <button type="submit"
                    class="validate text-uppercase"
                    [attr.aria-label]="'cta.save'|translate"
                    mat-raised-button
                    color="primary"
                    [disabled]="form.invalid"
                    [innerHtml]="'cta.save'|translate"></button>
          </div>
        </mat-card-actions>
      </mat-card>
    </form>
  </div>
  <div fxFlex="80">
    <app-admin-map-areas *ngIf="hideAreas === false"></app-admin-map-areas>
  </div>
</div>

